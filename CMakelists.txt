CMAKE_MINIMUM_REQUIRED(VERSION 3.0)
PROJECT(VRayGPUDecouple)

SET(PATH_TO_NVCC_EXE "C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.0/bin/nvcc.exe")

# Use nvcc from the local installation
INCLUDE_DIRECTORIES("C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.0/include")
LINK_DIRECTORIES("C:/Program Files/NVIDIA GPU Computing Toolkit/CUDA/v9.0/lib/x64")

ADD_SUBDIRECTORY(DiCLGatherPTX)
ADD_SUBDIRECTORY(DiNVCCExec)
ADD_SUBDIRECTORY(DiNVRTCProgram)
ADD_SUBDIRECTORY(MegaKernel)
ADD_SUBDIRECTORY(ProcessInstruction)
ADD_SUBDIRECTORY(Texture)
ADD_SUBDIRECTORY(TextureManager)
ADD_SUBDIRECTORY(Checker)
ADD_SUBDIRECTORY(Dirt)
ADD_SUBDIRECTORY(Ramp)

INCLUDE_DIRECTORIES(DiNVRTCProgram)
INCLUDE_DIRECTORIES(MegaKernel)
INCLUDE_DIRECTORIES(ProcessInstruction)
INCLUDE_DIRECTORIES(Texture)
INCLUDE_DIRECTORIES(TextureManager)

SET (
	EXTRA_LIBS
	cuda
	DiNVRTCProgram
	MegaKernel
	ProcessInstruction
	TextureManager
)

SET (
	HEADER_FILES
	di_vray.h
)

SET (
	SOURCE_FILES
	di_vray.cpp
	main.cpp
)

ADD_EXECUTABLE(VRayGPUDecouple ${HEADER_FILES} ${SOURCE_FILES})
TARGET_LINK_LIBRARIES(VRayGPUDecouple ${EXTRA_LIBS})
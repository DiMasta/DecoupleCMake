CMAKE_MINIMUM_REQUIRED(VERSION 3.0)
PROJECT(VRayGPUDecouple)

SET(VRAY_SDK_DIR "K:" CACHE FILEPATH "VRay sdk directory")
SET(PATH_TO_NVCC_EXE "${VRAY_SDK_DIR}/cuda/cuda7/bin/nvcc.exe")

# Use nvcc from the VRay SDK
INCLUDE_DIRECTORIES("${VRAY_SDK_DIR}/cuda/cuda7/include")
LINK_DIRECTORIES("${VRAY_SDK_DIR}/cuda/cuda7/lib/x64")

ADD_SUBDIRECTORY(DiCLGatherPTX)
ADD_SUBDIRECTORY(DiNVCCExec)
ADD_SUBDIRECTORY(DiNVRTCProgram)
ADD_SUBDIRECTORY(MegaKernel)
ADD_SUBDIRECTORY(ProcessInstruction)
ADD_SUBDIRECTORY(Texture)
ADD_SUBDIRECTORY(TextureManager)
ADD_SUBDIRECTORY(Checker)
ADD_SUBDIRECTORY(Dirt)
ADD_SUBDIRECTORY(Ramp)

INCLUDE_DIRECTORIES(DiNVRTCProgram)
INCLUDE_DIRECTORIES(MegaKernel)
INCLUDE_DIRECTORIES(ProcessInstruction)
INCLUDE_DIRECTORIES(Texture)
INCLUDE_DIRECTORIES(TextureManager)

SET (
	EXTRA_LIBS
	cuda
	DiNVRTCProgram
	MegaKernel
	ProcessInstruction
	TextureManager
)

SET (
	HEADER_FILES
	di_vray.h
)

SET (
	SOURCE_FILES
	di_vray.cpp
	main.cpp
)

ADD_EXECUTABLE(VRayGPUDecouple ${HEADER_FILES} ${SOURCE_FILES})
TARGET_LINK_LIBRARIES(VRayGPUDecouple ${EXTRA_LIBS})